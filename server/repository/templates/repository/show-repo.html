{% extends "repository/base.html" %}

{% block styles %}

.readme {
    min-height: 16em;
    padding: 1em;
}
{% endblock styles %}

{% block content %}
{% load repo_tags %}
<section class="section">
    <div class="columns is-vcentered">
        <div class="column is-narrow">
            <figure class="image is-32x32">
                <img class="is-rounded" src="https://bulma.io/assets/images/placeholders/64x64.png">
            </figure>
        </div>

        <div class="column">
            <p class="title is-5">{{ info.name }}</p>
        </div>
    </div>
</section>
<hr />
<div class="columns">
    <div class="column is-three-quarters">
        <div class="level">
            <div class="level-left">
                <div class="control has-icons-left">
                    <div class="select">
                        <select>
                            {% for branch in info.brranches %}
                            <option {% if branch == info.active_branch %}selected{% endif %} value="main">{{branch}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="icon is-small is-left">
                        <i class="fas fa-code-branch"></i>
                    </div>
                </div>
            </div>
            <div class="level-right">
                <a href="{% url 'repo_list_commits' username repo %}" class="button">
                    <span class="icon">
                        <i class="fas fa-code-commit"></i>
                    </span>
                    <span>{{ info.total_commits }} commits</span>
                </a>
            </div>
        </div>

        <div class="panel is-primary">
            <a class="panel-block is-active panel-head">
                <div class="level is-full">
                    <div class="level-left">
                        <span class="tag is-dark">{{ last_commit.hash|commit_short }}</span>
                    </div>
                    <div class="level-right">
                        <span id="autor" class="has-text-weight-bold has-text-primary">{{ last_commit.autor }}</span>
                    </div>
                    <div class="level-center">
                        <p class="has-text-ellipsis">{{ last_commit.message }}</p>
                    </div>
                </div>
            </a>

            {% for obj in tree %}
            <a class="panel-block" href="{% url "repo_show_file" username repo obj.name %}">
                <span class="panel-icon">
                    {% if obj.type == "tree" %}
                    <i class="fas fa-folder"></i>
                    {% elif obj.type == "blob" %}
                    <i class="fas fa-file"></i>
                    {% endif %}
                </span>
                {{obj.name}}
            </a>
            {% empty %}
            <div class="panel-block is-flex is-justify-content-center">
                <p class="has-text-ellipsis subtitle is-6">No hay archivos para mostrar</p>
            </div>
            {% endfor %}
        </div>

        <div class="panel readme">
            {% get_readme %}
        </div>
    </div>

    <div class="column">
        <div class="block">
            <h5 class="title is-5">Descripci√≥n</h5>
            <p class="subtitle is-6">{{ info.description }}</p>
        </div>

        <div class="block">
            <h6 class="title is-6"><b>Tags:</b></h6>
            <ul>
                {% for tag in tags %}
                <a href="#" class="tag">{{ tag.name }}</a>
                {% empty %}
                <span class="tag">---</span>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>
{% endblock content %}