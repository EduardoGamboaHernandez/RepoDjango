{% extends "base/base.html" %}

{% block styles %}
<style>
    .panel {
        --bulma-panel-heading-padding: 0.5em 0.75em;
        --bulma-shadow: none;
        --bulma-panel-heading-size: 1em;
        border: var(--bulma-panel-item-border);
        --bulma-panel-heading-weight: 400;

        overflow: hidden;

    }

    /* .select select {
    --bulma-scheme-main: hsl(var(--bulma-scheme-h), 5%, 30%);
    background-color: var(--bulma-scheme-main);
} */

    .readme {
        min-height: 16em;
        padding: 1em;
    }

    .navbar {
        margin-bottom: 2.5em;
    }

    .has-addons {
        --bulma-field-block-spacing: 0;
    }

    .last-commit {
        background: var(--bulma-panel-block-hover-background-color)
    }

    .has-text-ellipsis {
        display: -webkit-box;
        line-clamp: 1;
        -webkit-line-clamp: 1;
        /* Ajusta el número de líneas aquí */
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>
{% endblock styles %}



{% block content %}
{% load repo_tags %}
<div class="container">
    
    <div class="container">
    <div class="columns is-vcentered">
        <div class="column is-narrow">
            <figure class="image is-64x64">
                <img class="is-rounded" src="https://bulma.io/assets/images/placeholders/64x64.png" />
            </figure>
        </div>
        <div class="column">
            <p class="title is-4">Full Name</p>
            <p class="subtitle is-6">Username</p>
        </div>
    </div>

    <hr>
    <div class="columns">
        <div class="column is-three-quarters">

            <div class="level">
                <div class="level-left">
                    <div class="control has-icons-left">
                        <div class="select">
                            <select >
                                {% for branch in info.brranches %}
                                    <option {% if branch == info.active_branch %}selected{% endif %} value="main">{{branch}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="icon is-small is-left">
                            <i class="fas fa-code-branch"></i>
                        </div>
                    </div>
                </div>
                <div class="level-right">
                    <a href="{% url 'repo_list_commits' username repo %}" class="button">
                        <span class="icon">
                            <i class="fas fa-code-commit"></i>
                        </span>
                        <span>{{ info.total_commits }} commits</span>
                    </a>
                </div>
            </div>

            <nav class="panel is-primary">

                <a class="panel-block is-active last-commit ">
                    <div class="level is-full">
                        <div class="level-left">
                            <span class="tag is-dark">{{ last_commit.hash|commit_short }}</span>
                        </div>
                        <div class="level-right">
                            <span id="autor" class="has-text-weight-bold has-text-primary">{{ last_commit.autor }}</span>
                        </div>
                        <div class="level-center">
                            <p class="has-text-ellipsis">{{ last_commit.message }}</p>
                        </div>
                    </div>

                </a>
                
                {% for obj in tree %}
                    <a class="panel-block">
                        <span class="panel-icon">
                            {% if obj.type == "tree" %}
                                <i class="fas fa-folder">f</i>
                            {% elif obj.type == "blob" %}
                                <i class="fas fa-folder">d</i>
                            {% endif %}
                        </span>
                        {{obj.name}}
                    </a>
                {% empty %}
                <div class="panel-block is-flex is-justify-content-center">
                    <p class="has-text-ellipsis subtitle is-6">No hay archivos para mostrar</p>
                </div>
                {% endfor %}
            </nav>

            <div class="panel readme">
                {% get_readme %}
            </div>
        </div>
        <div class="column">
            
            <div class="block">
                <h4 class="title is-4">{{ info.name }}</h4>
                <p class="subtitle is-6">{{ info.description }}</p>
            </div>
            <div class="block">
                <h6 class="title is-6"><b>Tags</b></h6>
                <div class="panel-block">
                    <ul>
                        {% for tag in tags %}
                        <li><a href="#">{{tag}}</a></li>
                        {% empty %}
                        <p class="has-text-ellipsis subtitle is-6">---</p>
                        {% endfor %}
                    </ul>
                </div>
            </div>

            

        </div>
    </div>
</div>
{% endblock content %}